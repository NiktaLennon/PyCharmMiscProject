{% extends "base.html" %}

{% block title %}–û—Ç—á—ë—Ç - Expense Tracker{% endblock %}

{% block extra_styles %}
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin: 30px 0;
}

.stat-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 25px;
    border-radius: 12px;
    box-shadow: var(--shadow);
    transition: transform 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-5px);
}

.stat-card .icon {
    font-size: 2.5rem;
    margin-bottom: 10px;
}

.stat-card .label {
    font-size: 0.9rem;
    opacity: 0.9;
    margin-bottom: 5px;
}

.stat-card .value {
    font-size: 2rem;
    font-weight: bold;
}

.report-section {
    margin: 30px 0;
}

.section-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
    color: var(--text);
}

.section-header h3 {
    font-size: 1.5rem;
}

.table-wrapper {
    overflow-x: auto;
    border-radius: 12px;
    box-shadow: var(--shadow);
}

table {
    width: 100%;
    border-collapse: collapse;
    background: white;
}

thead {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
}

th {
    padding: 15px;
    text-align: left;
    font-weight: 600;
    font-size: 0.95rem;
}

td {
    padding: 12px 15px;
    border-bottom: 1px solid var(--border);
    color: var(--text);
}

tbody tr {
    transition: background 0.2s ease;
}

tbody tr:hover {
    background: var(--background);
}

tbody tr:last-child td {
    border-bottom: none;
}

.amount {
    font-weight: 600;
    color: var(--primary);
}

.actions {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin: 30px 0;
    flex-wrap: wrap;
}

.back-link {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    color: var(--text-light);
    text-decoration: none;
    margin-bottom: 20px;
    transition: color 0.3s ease;
}

.back-link:hover {
    color: var(--primary);
}

.empty-state {
    text-align: center;
    padding: 40px;
    color: var(--text-light);
}

.empty-state .icon {
    font-size: 4rem;
    margin-bottom: 15px;
}

@media (max-width: 768px) {
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    table {
        font-size: 0.9rem;
    }
    
    th, td {
        padding: 10px;
    }
}
{% endblock %}

{% block content %}
<a href="/" class="back-link">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>

<div class="card">
    <div class="card-header">
        <h2>üìä –û—Ç—á—ë—Ç –ø–æ —Ä–∞—Å—Ö–æ–¥–∞–º</h2>
    </div>
    <div class="card-body">
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">üí∞</div>
                <div class="label">–û–±—â–∞—è —Å—É–º–º–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤</div>
                <div class="value">{{ "%.2f"|format(total) }} ‚ÇΩ</div>
            </div>
            <div class="stat-card">
                <div class="icon">üìà</div>
                <div class="label">–°—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥</div>
                <div class="value">{{ "%.2f"|format(avg) }} ‚ÇΩ</div>
            </div>
        </div>

        <!-- –û—Ç—á—ë—Ç –ø–æ –º–µ—Å—è—Ü–∞–º -->
        {% if by_month %}
        <div class="report-section">
            <div class="section-header">
                <span style="font-size: 1.5rem;">üìÖ</span>
                <h3>–†–∞—Å—Ö–æ–¥—ã –ø–æ –º–µ—Å—è—Ü–∞–º</h3>
            </div>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>–ú–µ—Å—è—Ü</th>
                            <th>–°—É–º–º–∞</th>
                            <th>–°—Ä–µ–¥–Ω–µ–µ</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in by_month %}
                        <tr>
                            <td><strong>{{ row["month"] }}</strong></td>
                            <td class="amount">{{ "%.2f"|format(row["sum"]) }} ‚ÇΩ</td>
                            <td>{{ "%.2f"|format(row["avg"]) }} ‚ÇΩ</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}

        <!-- –û—Ç—á—ë—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
        {% if by_category %}
        <div class="report-section">
            <div class="section-header">
                <span style="font-size: 1.5rem;">üè∑Ô∏è</span>
                <h3>–†–∞—Å—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>
            </div>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                            <th>–°—É–º–º–∞</th>
                            <th>–°—Ä–µ–¥–Ω–µ–µ</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in by_category %}
                        <tr>
                            <td><strong>{{ row["category"] }}</strong></td>
                            <td class="amount">{{ "%.2f"|format(row["sum"]) }} ‚ÇΩ</td>
                            <td>{{ "%.2f"|format(row["avg"]) }} ‚ÇΩ</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}

        <!-- –û—Ç—á—ë—Ç –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
        {% if by_month_category %}
        <div class="report-section">
            <div class="section-header">
                <span style="font-size: 1.5rem;">üìä</span>
                <h3>–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>
            </div>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>–ú–µ—Å—è—Ü</th>
                            <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                            <th>–°—É–º–º–∞</th>
                            <th>–°—Ä–µ–¥–Ω–µ–µ</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in by_month_category %}
                        <tr>
                            <td><strong>{{ row["month"] }}</strong></td>
                            <td>{{ row["category"] }}</td>
                            <td class="amount">{{ "%.2f"|format(row["sum"]) }} ‚ÇΩ</td>
                            <td>{{ "%.2f"|format(row["avg"]) }} ‚ÇΩ</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}

        {% if not by_month and not by_category %}
        <div class="empty-state">
            <div class="icon">üì≠</div>
            <h3>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</h3>
            <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª —Å —Ä–∞—Å—Ö–æ–¥–∞–º–∏, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –æ—Ç—á—ë—Ç</p>
        </div>
        {% endif %}

        <!-- –î–µ–π—Å—Ç–≤–∏—è -->
        <div class="actions">
            <a href="/report/pdf" class="btn btn-secondary">
                üìÑ –°–∫–∞—á–∞—Ç—å PDF –æ—Ç—á—ë—Ç
            </a>
            <a href="/upload" class="btn btn-outline">
                üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
            </a>
        </div>
    </div>
</div>
{% endblock %}
